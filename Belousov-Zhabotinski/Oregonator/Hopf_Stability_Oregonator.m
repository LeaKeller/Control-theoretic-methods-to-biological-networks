function H = Hopf_Stability_Oregonator()

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This function computes the different eigenvalues for the Oregonator
% system. First, stability is checked by plotting the eigenvalues and the
% unit circle. Second, the Hopf bifurcations are performed regardinf the
% different equilibria.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    syms x z
    
    A = 0.06;
    B = 0.02;
    
    k1 = 1.28;
    k2 = 2.4*10^6;
    k3 = 33.6;
    k4 = 2400;
    k5 = 1;
    
    q = (2*k1*k4)/(k2*k3);
    e = k5/(k3*A);
    f = 1;
    
    f1 = (q/e)*((f*z)/(q+x)) - (1/e)*x*((f*z)/(q+x)) + (1/e)*x*(1-x);
    f2 = x-z;
    
    sol = vpasolve([f1 == 0 f2 == 0], [x,z]); % equilibrium points
    
    Df1x = diff(f1,x);
    Df1z = diff(f1,z);
    
    Df1x0 = [];
    Df1z0 = [];

    % Compute the equilibria using Jacobian matrix for the 2 variables reduced
    % model
    
    for i=1:size(sol.x,1)
        Df1x0 = [Df1x0 subs(Df1x, [x z], [sol.x(i), sol.z(i)])];
        Df1z0 = [Df1z0 subs(Df1z, [x z], [sol.x(i), sol.z(i)])];
    end
    
    % Compute the Jacobian matrices
    
    J1 = [Df1x0(1) Df1z0(1) ; 1 -1];
    J2 = [Df1x0(1) Df1z0(2) ; 1 -1];
    J3 = [Df1x0(1) Df1z0(3) ; 1 -1];
    J4 = [Df1x0(2) Df1z0(2) ; 1 -1];
    J5 = [Df1x0(3) Df1z0(3) ; 1 -1];
    J6 = [Df1x0(3) Df1z0(3) ; 1 -1];
    
    % Check that the eigenvalues are in the unit circle
    
    eigenval1 = eig(J1);     
    eigenval2 = eig(J2); 
    eigenval3 = eig(J3); 
    eigenval4 = eig(J4);     
    eigenval5 = eig(J5); 
    eigenval6 = eig(J6);

    l_eig1_real = [real(eigenval1(1)) real(eigenval2(1)) real(eigenval3(1)) real(eigenval4(1)) real(eigenval5(1)) real(eigenval6(1))];
    l_eig2_real = [real(eigenval1(2)) real(eigenval2(2)) real(eigenval3(2)) real(eigenval4(2)) real(eigenval5(2)) real(eigenval6(2))];
    l_eig1_imag = [imag(eigenval1(1)) imag(eigenval2(1)) imag(eigenval3(1)) imag(eigenval4(1)) imag(eigenval5(1)) imag(eigenval6(1))];
    l_eig2_imag = [imag(eigenval1(2)) imag(eigenval2(2)) imag(eigenval3(2)) imag(eigenval4(2)) imag(eigenval5(2)) imag(eigenval6(2))];
    
    Table1 = array2table(rand(2,6), 'VariableNames',{'\lambda_e_1','\lambda_e_2','\lambda_e_3', '\lambda_e_4', '\lambda_e_5', '\lambda_e_6'});    
    figure;
    for i=1:size(l_eig1_real,1)*size(l_eig1_real,2)
        VN = Table1.Properties.VariableNames;
        scatter([l_eig1_real(i), l_eig2_real(i)], [l_eig1_imag(i), l_eig2_imag(i)], "DisplayName", VN{i}); hold on; 
    end
    legend show;
    circle = @(x,y) x.^2 + y.^2 -1;
    ezplot(circle); hold on; % unit circle
    axis([-3 3 -3 3]);
    
    %Hopf bifurcation
    
    syms e f q
    
    TrJ = (2*f*z-(1-2*x)*(q+x))/(e*(q+x));
    DetJ = -((-2*f*z+(1-2*x)*(q+x))/(e*(q+x))+(f*(q-x))/(e*(q+x)));
    
    trJ = [];
    detJ =[];

    trJ1 = [trJ subs(TrJ, [x z], [sol.x(1), sol.z(1)])]; % substitute the value for TrJ at equilibria
    trJ2 = [trJ subs(TrJ, [x z], [sol.x(1), sol.z(2)])];
    trJ3 = [trJ subs(TrJ, [x z], [sol.x(1), sol.z(3)])];
    trJ4 = [trJ subs(TrJ, [x z], [sol.x(2), sol.z(2)])];
    trJ5 = [trJ subs(TrJ, [x z], [sol.x(3), sol.z(2)])];
    trJ6 = [trJ subs(TrJ, [x z], [sol.x(3), sol.z(3)])];
    
    trJ = [trJ1 trJ2 trJ3 trJ4 trJ5 trJ6];
  
    detJ1 = [detJ subs(DetJ, [x z], [sol.x(1), sol.z(1)])]; % substitute the value for DetJ at equilibria
    detJ2 = [detJ subs(DetJ, [x z], [sol.x(1), sol.z(2)])];
    detJ3 = [detJ subs(DetJ, [x z], [sol.x(1), sol.z(3)])];
    detJ4 = [detJ subs(DetJ, [x z], [sol.x(2), sol.z(2)])];
    detJ5 = [detJ subs(DetJ, [x z], [sol.x(3), sol.z(2)])];
    detJ6 = [detJ subs(DetJ, [x z], [sol.x(3), sol.z(3)])];
    
    detJ = [detJ1 detJ2 detJ3 detJ4 detJ5 detJ6];
    
    % Check for which values of f the value of the trace at equilibrium is
    % zero
    
    syms f q eps
    
    x_plus = ((1-q-f)+sqrt((1-q-f)^2+4*q*(1-f)))/2;
    Trace_J = (2*f*x_plus-(1-2*x_plus)*(q+x_plus))/(eps*(q+x_plus));
    
    Tr_sol = solve(Trace_J == 0, [f,q,eps]);
    
    % Check stability, plot Tr(J) in the stability diagram, if Tr(J)>0
    % (unstable), if Tr(J)<0 (stable)
    
    eps = k5/(k3*A);
    f = 0:0.1:3;
    Tr_J = [];
    
    for i = 1:length(f)
        q(i) = (2*(f(i)+1)+(2*f(i)+2)^2-4*(f(i)^2+6*f(i)-3))/2;
        x_plus = (-q(i)+sqrt(q(i).^2+8*q(i)))./2;
        Tr_J = [Tr_J (2.*f(i).*x_plus-(1-2.*x_plus).*(q(i)+x_plus))./(eps.*(q(i)+x_plus))];
    end
    
    figure;
    plot3(f, q, Tr_J);
    yline(0,'--r',{'Tr(J)=0'});
    grid on;
    title('Stability diagram');
    xlabel('q');
    ylabel('f');
    zlabel('Trace');
    
    % Check stability, plot Tr(J) in the stability diagram, if Tr(J)>0
    % (unstable), if Tr(J)<0 (stable)
    
    syms q eps
    
    f= 1;
    for i = 1:length(eps)
        q(i) = (2*k1*k4*A)/(k2*k5)*eps(i);
        x_plus = (-q(i)+sqrt(q(i).^2+8*q(i)))./2;
        Tr_J = (2.*f.*x_plus-(1-2.*x_plus).*(q(i)+x_plus))./(eps.*(q(i)+x_plus));
    end
    
    figure;
    fplot3(q, eps, Tr_J);
    yline(0,'--r',{'Tr(J)=0'});
    title('Stability diagram');
%     txt_stable = 'Stable';
%     txt_unstable = 'Unstable';
%     text(2,2.5,-1,txt_stable);
%     text(2,-1,50,txt_unstable);
    xlabel('q');
    ylabel('\epsilon');
    zlabel('Trace');

    % Hopf bifurcation with f as bifurcation parameter
    
    syms e q f
    
    f1 = (q/e)*((f*z)/(q+x)) - (1/e)*x*((f*z)/(q+x)) + (1/e)*x*(1-x);
    f2 = x-z;

    sol = vpasolve([f1 == 0 f2 == 0], [x,z]); % equilibrium points

    Df1x = diff(f1,x);
    Df1z = diff(f1,z);
    
    % Different Jacobian computed at the different equilibrium
    Df1x_1 = subs(Df1x, [x z], [sol.x(1), sol.z(1)]);
    Df1x_2 = subs(Df1z, [x z], [sol.x(2), sol.z(2)]);
    Df1x_3 = subs(Df1z, [x z], [sol.x(3), sol.z(3)]);
    
    % Different eigenvalues computed at the different equilibrium (where
    % x=z as shown in the report)
    L1_1 = -(1/2)*((Df1x_1-1)+4*sqrt((1-Df1x_1)^2-4*(Df1x_1)));
    L2_1 = -(1/2)*((Df1x_1-1)-4*sqrt((1-Df1x_1)^2-4*(Df1x_1)));
    L1_2 = -(1/2)*((Df1x_2-1)+4*sqrt((1-Df1x_2)^2-4*(Df1x_2)));
    L2_2 = -(1/2)*((Df1x_2-1)-4*sqrt((1-Df1x_2)^2-4*(Df1x_2)));
    L1_3 = -(1/2)*((Df1x_3-1)+4*sqrt((1-Df1x_3)^2-4*(Df1x_3)));
    L2_3 = -(1/2)*((Df1x_3-1)-4*sqrt((1-Df1x_3)^2-4*(Df1x_3)));
    
    n = 14;
    q = (2*k1*k4)/(k2*k3);
    e = k5/(k3*A);
    f = [0.1, 0.5, 0.7, 1, 1.2, 1+sqrt(2),3];

    c = ['r','g','b','c','m','y','k','w',[0.6350 0.0780 0.1840],[0.3010 0.7450 0.9330],[0.4660 0.6740 0.1880],[0.4940 0.1840 0.5560],[0.9290 0.6940 0.1250],[0.8500 0.3250 0.0980],[0 0.4470 0.7410]];
    
    figure;
    for i = 1:length(f)
        txt = ['f =', num2str(f(i))];
        l1_1(i) = 1/2 - 2*((1/e - 1)^2 - (4*f(i))/e)^(1/2) - 1/(2*e);
        l2_1(i) = (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) - (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e) - 2*(((0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e - (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + (f(i)*q*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (4*f(i)*q)/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)))^(1/2) - (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - (f(i)*q*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + 1/2;
        scatter([real(l1_1(i)),real(l1_2(i))], [imag(l1_1(i)),imag(l1_2(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_1),imag(l1_1),'DisplayName','\lambda_1');
    plot(real(l2_1),imag(l2_1),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    figure;
    for i = 1:length(f)
        txt = ['f =', num2str(f(i))];
        l1_2(i) = (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) - (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e) - 2*(((0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e - (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + (f(i)*q*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (4*f(i)*q)/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)))^(1/2) - (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - (f(i)*q*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + 1/2;
        l2_2(i) = 2*(((0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e - (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + (f(i)*q*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (4*f(i)*q)/(e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)))^(1/2) - (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e) + (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) - (f(i)*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - (f(i)*q*(0.5*f(i) + 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + 1/2;
        scatter([real(l2_1(i)),real(l2_2(i))], [imag(l2_1(i)),imag(l2_2(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_2),imag(l1_2),'DisplayName','\lambda_1');
    plot(real(l2_2),imag(l2_2),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    figure;
    for i = 1:length(f)
        txt = ['f =', num2str(f(i))];
        l1_3(i) = 1/2 - (0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e) - (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - (f(i)*q*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - 2*(((0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e + (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) + (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) + (f(i)*q*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - 1)^2 - (4*f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (4*f(i)*q)/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)))^(1/2);
        l2_3(i) = 2*(((0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e + (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) + (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) + (f(i)*q*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - 1)^2 - (4*f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (4*f(i)*q)/(e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)))^(1/2) - (0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e) - (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (f(i)*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - (f(i)*q*(0.5*f(i) + 0.5*q - 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q - 2.0*f(i) + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) + 1/2;
        scatter([real(l1_3(i)),real(l2_3(i))], [imag(l1_3(i)),imag(l2_3(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_3),imag(l1_3),'DisplayName','\lambda_1');
    plot(real(l2_3),imag(l2_3),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;

    % Plots for q as bifurcation parameter
    
    n = 14;
    q = (2*k1*k4)/(k2*k3);
    e = k5/(k3*A);
    f = [0.1, 0.5, 0.7, 1, 1.2];
    q = [];
    for j = 1:length(f)
        q = [q (2*(f(j)+1)+(2*f(j)+2)^2-4*(f(j)^2+6*f(j)-3))/2];
    end

    c = ['r','g','b','c','m','y','k','w',[0.6350 0.0780 0.1840],[0.3010 0.7450 0.9330],[0.4660 0.6740 0.1880],[0.4940 0.1840 0.5560],[0.9290 0.6940 0.1250],[0.8500 0.3250 0.0980],[0 0.4470 0.7410]];
    
    figure;
    for i = 1:length(q)
        txt = ['q =', num2str(q(i))];
        l1_1(i) = 1/2 - 2*((1/e - 1)^2 - (4*f(i))/e)^(1/2) - 1/(2*e);
        l1_2(i) = (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) - (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/(2*e) - 2*(((0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/e - (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) + (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) + (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) + (4*f(i)*q(i))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)))^(1/2) - (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) - (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) + 1/2;
        scatter([real(l1_1(i)),real(l1_2(i))], [imag(l1_1(i)),imag(l1_2(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_1),imag(l1_1),'DisplayName','\lambda_1');
    plot(real(l1_2),imag(l1_2),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    figure;
    for i = 1:length(q)
        txt = ['q =', num2str(q(i))];
        l2_1(i) = (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) - (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/(2*e) - 2*(((0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/e - (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) + (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) + (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) + (4*f(i)*q(i))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)))^(1/2) - (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) - (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) + 1/2;
        l2_2(i) = 2*(((0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/e - (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) + (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) + (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) + (4*f(i)*q(i))/(e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)))^(1/2) - (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/(2*e) + (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)) - (f(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) - (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*f(i) - 0.5*q(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2) + 1/2;
        scatter([real(l2_1(i)),real(l2_2(i))], [imag(l2_1(i)),imag(l2_2(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_2),imag(l1_2),'DisplayName','\lambda_1');
    plot(real(l2_2),imag(l2_2),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    figure;
    for i = 1:length(q)
        txt = ['q =', num2str(q(i))];
        l1_3(i) = 1/2 - (0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/(2*e) - (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)) - (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) - (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) - 2*(((0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/e + (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)) + (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) + (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) - 1)^2 - (4*f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)) - (4*f(i)*q(i))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)))^(1/2);
        l2_3(i) = 2*(((0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/e + (0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/e + (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)) + (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) + (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) - 1)^2 - (4*f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)) - (4*f(i)*q(i))/(e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)))^(1/2) - (0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)/(2*e) - (0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)/(2*e) - (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)) - (f(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5)^2)/(2*e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) - (f(i)*q(i)*(0.5*f(i) + 0.5*q(i) - 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) - 0.5))/(2*e*(0.5*q(i) - 0.5*f(i) + 0.5*(f(i)^2 + 6.0*f(i)*q(i) - 2.0*f(i) + q(i)^2 + 2.0*q(i) + 1.0)^(1/2) + 0.5)^2) + 1/2;
        scatter([real(l1_3(i)),real(l2_3(i))], [imag(l1_3(i)),imag(l2_3(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_3),imag(l1_3),'DisplayName','\lambda_1');
    plot(real(l2_3),imag(l2_3),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
 
    % compute the eigenvalues of the Jacobian 
    % First compute the characteristic polynomial 
    syms lam
    Jac_l = [b-1-lam a^2 ; -b -a^2-lam];
    lamP = charpoly(Jac,lam);
    eigenvalues = eig(Jac_l);

    format rat

    n = 14;
    a=3; 
    b = [];
    for j = 1:n
        b = [b, 1.5*j];
    end
    c = ['r','g','b','c','m','y','k','w',[0.6350 0.0780 0.1840],[0.3010 0.7450 0.9330],[0.4660 0.6740 0.1880],[0.4940 0.1840 0.5560],[0.9290 0.6940 0.1250],[0.8500 0.3250 0.0980],[0 0.4470 0.7410]];
    
    figure;
    for i = 1:n
        txt = ['b =', num2str(b(i))];
        l1(i) = b(i)/2 - (-(- a^2 + 2*a + b(i) - 1)*(a^2 + 2*a - b(i) + 1))^(1/2)/2 - a^2/2 - 1/2;
        l2(i) = b(i)/2 + (-(- a^2 + 2*a + b(i) - 1)*(a^2 + 2*a - b(i) + 1))^(1/2)/2 - a^2/2 - 1/2;
        scatter([real(l1(i)),real(l2(i))], [imag(l1(i)),imag(l2(i))], c(i), 'DisplayName', txt); hold on;
    end
    title('a=3');
    plot(real(l1),imag(l1),'DisplayName','\lambda_1');
    plot(real(l2),imag(l2),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
   % Hopf bifurcation with e as bifurcation parameter
    
    syms e q f
    
    f1 = (q/e)*((f*z)/(q+x)) - (1/e)*x*((f*z)/(q+x)) + (1/e)*x*(1-x);
    f2 = x-z;

    sol = vpasolve([f1 == 0 f2 == 0], [x,z]); % equilibrium points

    Df1x = diff(f1,x);
    Df1z = diff(f1,z);
    
    % Different Jacobian computed at the different equilibrium
    Df1x_1 = subs(Df1x, [x z], [sol.x(1), sol.z(1)]);
    Df1x_2 = subs(Df1z, [x z], [sol.x(2), sol.z(2)]);
    Df1x_3 = subs(Df1z, [x z], [sol.x(3), sol.z(3)]);
    
    % Different eigenvalues computed at the different equilibrium (where
    % x=z as shown in the report)
    L1_1 = -(1/2)*((Df1x_1-1)+4*sqrt((1-Df1x_1)^2-4*(Df1x_1)));
    L2_1 = -(1/2)*((Df1x_1-1)-4*sqrt((1-Df1x_1)^2-4*(Df1x_1)));
    L1_2 = -(1/2)*((Df1x_2-1)+4*sqrt((1-Df1x_2)^2-4*(Df1x_2)));
    L2_2 = -(1/2)*((Df1x_2-1)-4*sqrt((1-Df1x_2)^2-4*(Df1x_2)));
    L1_3 = -(1/2)*((Df1x_3-1)+4*sqrt((1-Df1x_3)^2-4*(Df1x_3)));
    L2_3 = -(1/2)*((Df1x_3-1)-4*sqrt((1-Df1x_3)^2-4*(Df1x_3)));
    
    n = 14;
    q = (2*k1*k4)/(k2*k3);
    C = (k2*k5)/(2*k1*k4*A);
    f = [0.1, 0.5, 0.7, 1, 1.2];
    e = [];
    for j = 1:length(f)
        q(i) = (2*(f(j)+1)+(2*f(j)+2)^2-4*(f(j)^2+6*f(j)-3))/2;
        e = [e C*q(i)];
    end

    c = ['r','g','b','c','m','y','k','w',[0.6350 0.0780 0.1840],[0.3010 0.7450 0.9330],[0.4660 0.6740 0.1880],[0.4940 0.1840 0.5560],[0.9290 0.6940 0.1250],[0.8500 0.3250 0.0980],[0 0.4470 0.7410]];
    
    figure;
    for i = 1:length(q)
        txt = ['e =', num2str(e(i))];
        l1_1(i) = 1/2 - 2*((1/e(i) - 1)^2 - (4*f)/e(i)).^(1/2) - 1/(2*e(i)); 
        l2_1(i) = (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) - (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e(i)) - (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e(i)) - 2*(((0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e(i) + (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e(i) - (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + (f*q*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (4*f*q)/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)))^(1/2) - (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - (f*q*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + 1/2;
        scatter([real(l1_1(i)),real(l2_1(i))], [imag(l1_1(i)),imag(l2_1(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_1),imag(l1_1),'DisplayName','\lambda_1');
    plot(real(l2_1),imag(l2_1),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    figure;
    for i = 1:n
        txt = ['e =', num2str(e(i))];
        l1_2(i) = (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) - (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e(i)) - (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e(i)) - 2*(((0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e(i) + (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e(i) - (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + (f*q*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (4*f*q)/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)))^(1/2) - (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - (f*q*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + 1/2;
        l2_2(i) = 2*(((0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e(i) + (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e(i) - (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + (f*q*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - 1)^2 + (4*f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) + (4*f*q)/(e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)))^(1/2) - (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e(i)) - (0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e(i)) + (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)) - (f*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) - (f*q*(0.5*f + 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*f - 0.5*q + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2) + 1/2;
        scatter([real(l1_2(i)),real(l2_2(i))], [imag(l1_2(i)),imag(l2_2(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_2),imag(l1_2),'DisplayName','\lambda_1');
    plot(real(l2_2),imag(l2_2),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    figure;
    for i = 1:n
        txt = ['e =', num2str(e(i))];
        l1_3(i) = 1/2 - (0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e(i)) - (0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e(i)) - (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - (f*q*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - 2*(((0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e(i) + (0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e(i) + (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) + (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) + (f*q*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - 1)^2 - (4*f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (4*f*q)/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)))^(1/2);
        l2_3(i) = 2*(((0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/e(i) + (0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/e(i) + (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) + (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) + (f*q*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - 1)^2 - (4*f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (4*f*q)/(e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)))^(1/2) - (0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)/(2*e(i)) - (0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)/(2*e(i)) - (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)) - (f*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5)^2)/(2*e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) - (f*q*(0.5*f + 0.5*q - 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) - 0.5))/(2*e(i)*(0.5*q - 0.5*f + 0.5*(f^2 + 6.0*f*q - 2.0*f + q^2 + 2.0*q + 1.0)^(1/2) + 0.5)^2) + 1/2;
        scatter([real(l1_3(i)),real(l2_3(i))], [imag(l1_3(i)),imag(l2_3(i))], c(i), 'DisplayName', txt); hold on;
    end
    plot(real(l1_3),imag(l1_3),'DisplayName','\lambda_1');
    plot(real(l2_3),imag(l2_3),'DisplayName','\lambda_2');
    xlabel('\Re(\lambda)');
    ylabel('\Im(\lambda)');
    legend show;
    
    % Draw the contour plot of the distribution of equilibria
    x = linspace(-10,10);
    y = linspace(-10,10);
    [f,q] = meshgrid(x,y);
    Z1 = ((1-q-f)+sqrt((1-q-f)^2+4*q*(1+f)))/2;
    Z2 = ((1-q-f)-sqrt((1-q-f)^2+4*q*(1+f)))/2;
    
    figure;
    mesh(real(Z1));
    colorbar;
    title('Mesh plot for the equilibrium ^{(1-q-f)+sqrt{(1-q-f)^2-4q(1+f)}}/_{2}');
    xlabel('f');
    ylabel('q');
    
    figure;
    mesh(real(Z2));
    colorbar;
    title('Mesh plot for the equilibrium ^{(1-q-f)-sqrt{(1-q-f)^2-4q(1+f)}}/_{2}');
    xlabel('f');
    ylabel('q');
    
    figure;
    contour(q,f,real(Z1), 'ShowText', 'on'); hold on;
    plot(x,y);
    colorbar;
    title('Contour plot for the equilibrium ^{(1-q-f)+sqrt{(1-q-f)^2+4q(1+f)}}/_{2}');
    xlabel('f');
    ylabel('q');
    
    figure;
    contour(q,f,real(Z2), 'ShowText', 'on'); hold on;
    plot(x,y);
    colorbar;
    title('Contour plot for the equilibrium ^{(1-q-f)-sqrt{(1-q-f)^2+4q(1+f)}}/_{2}');
    xlabel('f');
    ylabel('q');
    
    % Trace
    q = (2*k1*k4)/(k2*k3);
    e = k5/(k3*A);
    f = [0.1, 0, 1, 2, 1+sqrt(2), 5];
    
    x = linspace(-10,10);
    y = linspace(-10,10);
    [X,Y] = meshgrid(x,y);
    
    f = 0.1;
    TrJ = (2*f*Y-(1-2*X).*(q+X))./(e*(q+X));
    figure;
    mesh(TrJ);
    title('Mesh plot of Tr(J) for f=0.1, q and \epsilon fixed');
    xlabel('x');
    ylabel('z');
        
    f = 1;
    TrJ = (2*f*Y-(1-2*X).*(q+X))./(e*(q+X));
    figure;
    mesh(TrJ);
    title('Mesh plot of Tr(J) for f=1, q and \epsilon fixed');
    xlabel('x');
    ylabel('z');
    
    % Check for which f stability of the positive equilibria occurs
    e = k5/(k3*A);
    f = [0.1, 1, 1.2, 1.3, 1+sqrt(2), 3];
    figure;
    for i = 1:length(f)
        q = (2*(f(i)+1)+sqrt(2*(f(i)+2)^2-4*(f(i)^2+6*f(i)-3)))/2;
        eq_positiv = (-q+sqrt(q^2+8))/2;
        TrJ = (2*f(i)*eq_positiv - (1-2*eq_positiv)*(q+eq_positiv))/(e*(q+eq_positiv));
        scatter(f(i), TrJ); hold on;
    end
    title('Scatter plot of the different Trace values for different ranges of f');
    xlabel('f');
    ylabel('Tr');
    figure;
    for i = 1:length(f)
        q = (2*(f(i)+1)+sqrt(2*(f(i)+2)^2-4*(f(i)^2+6*f(i)-3)))/2;
        eq_positiv = (-q+sqrt(q^2+8))/2;
        DetJ = -((-2*f(i)*eq_positiv+(1-2*eq_positiv)*(q+eq_positiv))/(e*(q+eq_positiv))+(f(i)*(q-eq_positiv))/(e*(q+eq_positiv)));
        scatter(f(i), DetJ); hold on;
    end
    title('Scatter plot of the different Determinant values for different ranges of f');
    xlabel('f');
    ylabel('Det');
    
end