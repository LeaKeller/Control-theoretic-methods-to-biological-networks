%% Plot polyhedral

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% For this, the function from Guilia's paper is used in order to compute
% BDC decomposition and to get the set of the polyhedral vertices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function P = Polyhedral()
    k1 = 1;
    k2 = 0.1;
    k3 = 1;
    k4 = 0.1;
    k5 = 1;
    k6 = 0.1;
    ki = 1;

    alpha = k2/(k1*k3*(k5/ki))^(1/3);
    beta = k4/(k1*k3*(k5/ki))^(1/3);
    gamma = k6/(k1*k3*(k5/ki))^(1/3);

    S = [1 -alpha 0 0 ; 0 1 -beta 0 ; 0 0 1 -gamma];%[-1 0 1 ; 1 -1 0 ; 0 1 -1];
    g = [0 0 3 ; 1 0 0 ; 0 2 0 ; 0 0 3];%[1 0 3 ; 1 2 0 ; 0 2 3];

    M = SSIM_general(S,g);
    [B, C] = generateBCmatrices(S,g);

    syms z n
    a1 = abs((n*z^(n-1))/(1+z^n)^2);
    a2 = 1;
    a3 = 1;
    a4 = 1;
    D = [a1 0 0 0 ; 0 a2 0 0 ; 0 0 a3 0 ; 0 0 0 a4];

    X1 = polychemtest(B,C,100,1);
    
    % Draw polyhedral 
    
    X = [0.6482   -0.6482    0.8958   -0.8958    0.9225   -0.9225    1.2749   -1.2749    1.3093   -1.3093    1.8094  -1.8094    1.9564   -1.9564    1.5855   -1.5855    2.7036   -2.7036    2.6123   -2.6123    2.7923   -2.7923 2.6406   -2.6406    2.3115   -2.3115    2.4595   -2.4595    0.6482   -0.6482    0.9225   -0.9225    0.4446  -0.4446    0.6482   -0.6482    0.4446   -0.4446];
    Y = [0.3124   -0.3124    0.3124   -0.3124    0.4446   -0.4446    0.4446   -0.4446    0.6310   -0.6310    0.6310 -0.6310    0.9429   -0.9429    1.1854   -1.1854    0.9429   -0.9429    1.1854   -1.1854    1.3458   -1.3458 1.3030   -1.3030    1.7281   -1.7281    2.0593   -2.0593    2.3763   -2.3763    2.4595   -2.4595    2.9041  -2.9041    3.0022   -3.0022    2.8459   -2.8459];
    Z = [2.7433   -2.7433    2.8379   -2.8379    2.9819   -2.9819    2.7641   -2.7641    2.9228   -2.9228    2.1135 -2.1135    2.4108   -2.4108    2.5780   -2.5780    0.4544   -0.4544    0.9925   -0.9925    0.6486   -0.6486 0.4544   -0.4544    1.4469   -1.4469    0.9925   -0.9925    2.0951   -2.0951    2.0593   -2.0593    1.4371  -1.4371    1.4469   -1.4469    0.9925   -0.9925];
    figure;
    points = scatter3(X,Y,Z);
    figure;
    poly = polyshape();
    plot3();
    figure;
    [k1,av1] = convhull(X,Y,Z);
    trisurf(k1,X,Y,Z,'FaceColor','cyan');
    figure;
    plot3(X,Y,Z); 
    grid on;
end